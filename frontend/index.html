<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/styles.css" />
    <title>Busca CNPJ Simples - API</title>
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <nav class="navigation-menu">
        <h1>Busca CNPJ Simples API</h1>
      </nav>
    </header>

    <!-- HERO -->
    <main>
      <section class="hero">
        <h2>Consulta de CNPJs simplificada</h2>
        <p>
          A <strong>Busca CNPJ Simples</strong> √© uma API p√∫blica e open-source
          para consultas r√°pidas de CNPJs da Receita Federal. Ideal para
          integra√ß√µes e automa√ß√µes em sistemas, sem a necessidade de tokens para
          a autentica√ß√£o.
        </p>
        <!-- <a
          href="https://github.com/iamhenriquemachado/buscacnpjsimples"
          target="_blank"
          class="button"
          >Ver no GitHub</a
        > -->

        <!-- SOBRE A API -->
        <section class="section-api">
          <h3>Sobre a API</h3>
          <p>
            A <strong>Busca CNPJ Simples</strong> utiliza a base p√∫blica de
            CNPJs disponibilizada pela Receita Federal, permitindo consultas
            r√°pidas e simplificadas de informa√ß√µes cadastrais de empresas, sem a
            necessidade de lidar com arquivos massivos.
          </p>
          <p>
            Os dados s√£o atualizados mensalmente, sempre que a Receita Federal
            libera um novo arquivo ‚Äî geralmente no in√≠cio de cada m√™s. Nosso
            processo de atualiza√ß√£o garante que a API esteja sincronizada em at√©
            <strong>3 a 4 dias</strong>
            ap√≥s a publica√ß√£o oficial.
          </p>
          <p>
            Se preferir, voc√™ tamb√©m pode acessar diretamente os arquivos
            originais da Receita Federal atrav√©s deste link:
            <a
              href="https://arquivos.receitafederal.gov.br/dados/cnpj/dados_abertos_cnpj/"
              target="_blank"
              rel="noopener noreferrer"
            >
              Base de Dados - Receita Federal </a
            >.
          </p>
        </section>
      </section>

      <!-- COMO USAR -->
      <section class="section-api">
        <h3>Como usar</h3>
        <p>Fa√ßa requisi√ß√µes HTTP utilizando o CNPJ desejado:</p>
        <div class="code-label">Requisi√ß√£o</div>
        <pre>GET https://api-buscacnpjsimples.com.br/cnpj/00000000000191</pre>

        <div class="code-label">Resposta JSON</div>
        <pre>{
  <span class="json-key">"cnpj"</span><span class="json-punctuation">:</span> <span class="json-string">"00000000000191"</span><span class="json-punctuation">,</span>
  <span class="json-key">"razao_social"</span><span class="json-punctuation">:</span> <span class="json-string">"EMPRESA EXEMPLO LTDA"</span><span class="json-punctuation">,</span>
  <span class="json-key">"nome_fantasia"</span><span class="json-punctuation">:</span> <span class="json-string">"EMPRESA EXEMPLO"</span><span class="json-punctuation">,</span>
  <span class="json-key">"uf"</span><span class="json-punctuation">:</span> <span class="json-string">"SP"</span><span class="json-punctuation">,</span>
  <span class="json-key">"municipio"</span><span class="json-punctuation">:</span> <span class="json-string">"S√£o Paulo"</span><span class="json-punctuation">,</span>
  <span class="json-key">"data_abertura"</span><span class="json-punctuation">:</span> <span class="json-string">"1995-07-12"</span>
}</pre>
      </section>

      <!-- TESTE A API -->
      <section class="api-test">
        <h3>Teste a API</h3>
        <p>Digite um CNPJ para consultar as informa√ß√µes:</p>
        <form class="test-form" id="testForm">
          <input
            type="text"
            id="cnpjInput"
            placeholder="00000000000191"
            maxlength="14"
            pattern="[0-9]*"
          />
          <button type="submit">Consultar</button>
        </form>
      </section>

      <section class="section-api">
        <h3>Como a API foi Constru√≠da</h3>

        <p>
          <strong>Pipeline ETL:</strong> Pipeline automatizado que extrai dados
          da Receita Federal, converte para formato Parquet (otimizado para
          processamento) e carrega em PostgreSQL. Arquitetura modular em Python
          com componentes especializados: <code>downloader.py</code>,
          <code>processor.py</code>, <code>parquet_converter.py</code> e
          <code>database.py</code>.
        </p>
        <br />
        <p>
          <strong>Stack:</strong> FastAPI + Python 3.11, PostgreSQL, Docker e
          VPS. Documenta√ß√£o autom√°tica via Swagger, c√≥digo versionado no GitHub
          para total transpar√™ncia e contribui√ß√µes open-source.
        </p>
        <br />
        <p>
          <strong>Processo de Atualiza√ß√£o:</strong> Atualiza√ß√£o mensal
          automatizada via cron scheduler, com janela de 2-4 dias ap√≥s
          publica√ß√£o da Receita Federal. O sistema detecta, processa e atualiza
          os dados sem interven√ß√£o manual.
        </p>
      </section>

      <!-- APOIE O PROJETO -->
      <section class="support">
        <h3>Apoie este projeto üíö</h3>
        <p>
          Este projeto √© gratuito e open-source. Se ele te ajuda, considere
          apoiar para manter a API online e sempre atualizada.
        </p>

        <div class="support-buttons">
          <!-- PIX -->
          <button class="pix-button" onclick="copyPixKey()">
            üí∞ Copiar chave Pix
          </button>

          <!-- BUY ME A COFFEE -->
          <a
            href="https://www.buymeacoffee.com/seulink"
            target="_blank"
            class="coffee-button"
          >
            ‚òï Buy me a coffee
          </a>
        </div>

        <p id="pixMessage" class="pix-message"></p>
      </section>

      <section class="faq">
        <h3>Perguntas Frequentes</h3>

        <div class="faq-item">
          <button class="faq-question">A API √© gratuita?</button>
          <div class="faq-answer">
            <p>
              Sim, a API Busca Cnpj Simples √© gratuita. N√£o oferecemos suporte
              dedicado, pois o projeto √© open-source.
            </p>
          </div>
        </div>

        <div class="faq-item">
          <button class="faq-question">
            Os dados s√£o consultados/atualizados em tempo real?
          </button>
          <div class="faq-answer">
            <p>
              N√£o. Os dados s√£o atualizados mensalmente de acordo com a base de
              dados da Receita Federal do Brasil.
            </p>
          </div>
        </div>

        <div class="faq-item">
          <button class="faq-question">
            Quanto tempo ap√≥s a publica√ß√£o da Receita Federal voc√™s atualizam a
            base?
          </button>
          <div class="faq-answer">
            <p>Em m√©dia de 2 a 3 dias ap√≥s a publica√ß√£o no site oficial.</p>
          </div>
        </div>

        <div class="faq-item">
          <button class="faq-question">
            Existem limites de requisi√ß√£o para o uso da API?
          </button>
          <div class="faq-answer">
            <p>
              Sim, existe um limite de 50 requisi√ß√µes por IP/segundo. Caso voc√™
              ultrapasse este limite, iremos aplicar dois bloqueios tempor√°rios
              e no terceiro, seu IP ser√° bloqueado definitivamente.
            </p>
          </div>
        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer>
      <p>¬© 2025 Brasil CNPJ Simples. Open-source sob licen√ßa MIT.</p>
    </footer>

    <!-- MODAL -->
    <div class="modal-overlay" id="modalOverlay">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Resultado da Consulta</h3>
          <button class="modal-close" id="modalClose">&times;</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
      </div>
    </div>

    <script>
      document.querySelectorAll(".faq-question").forEach((btn) => {
        btn.addEventListener("click", () => {
          const item = btn.parentElement;
          item.classList.toggle("active");
        });
      });

      // Teste da API
      const testForm = document.getElementById("testForm");
      const cnpjInput = document.getElementById("cnpjInput");
      const modalOverlay = document.getElementById("modalOverlay");
      const modalClose = document.getElementById("modalClose");
      const modalBody = document.getElementById("modalBody");

      // Permitir apenas n√∫meros no input
      cnpjInput.addEventListener("input", (e) => {
        e.target.value = e.target.value.replace(/\D/g, "");
      });

      testForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const cnpj = cnpjInput.value.trim();

        if (cnpj.length !== 14) {
          showModal(
            '<div class="error-message">Por favor, digite um CNPJ v√°lido com 14 d√≠gitos.</div>'
          );
          return;
        }

        const button = testForm.querySelector("button");
        button.disabled = true;
        button.textContent = "Consultando...";

        try {
          const response = await fetch(`https://suaapi.com.br/cnpj/${cnpj}`);
          const data = await response.json();

          if (response.ok) {
            const formattedJson = JSON.stringify(data, null, 2);
            const highlightedJson = highlightJson(formattedJson);
            showModal(`<pre>${highlightedJson}</pre>`);
          } else {
            showModal(
              `<div class="error-message">Erro: ${
                data.message || "CNPJ n√£o encontrado"
              }</div>`
            );
          }
        } catch (error) {
          showModal(
            '<div class="error-message">Erro ao consultar a API. Verifique sua conex√£o.</div>'
          );
        } finally {
          button.disabled = false;
          button.textContent = "Consultar";
        }
      });

      function highlightJson(json) {
        return json
          .replace(
            /"([^"]+)":/g,
            '<span class="json-key">"$1"</span><span class="json-punctuation">:</span>'
          )
          .replace(/: "([^"]+)"/g, ': <span class="json-string">"$1"</span>')
          .replace(/([,{}[\]])/g, '<span class="json-punctuation">$1</span>');
      }

      function showModal(content) {
        modalBody.innerHTML = content;
        modalOverlay.classList.add("active");
      }

      modalClose.addEventListener("click", () => {
        modalOverlay.classList.remove("active");
      });

      modalOverlay.addEventListener("click", (e) => {
        if (e.target === modalOverlay) {
          modalOverlay.classList.remove("active");
        }
      });
    </script>
  </body>
</html>
